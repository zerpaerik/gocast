import{A as se,C as de,b as H,c as Q,e as C,g as W,h as X,n as ee,o as ie,r as te,t as re,u as oe,v as ae,x as ne,y as le}from"./chunk-LWEV5N6L.js";import{i as Z,k,o as j}from"./chunk-6SH7557L.js";import{A as O,Ba as x,Ca as F,Hc as n,Ic as y,Jc as f,Ma as w,Na as D,Pd as J,Qb as c,Qd as V,Rd as P,Vb as s,Wb as G,Wc as $,Xb as R,_c as L,ae as U,ce as Y,hc as o,ic as r,jc as h,nc as z,q as u,qa as B,ra as I,tc as p,vc as E,yb as l,zb as v}from"./chunk-XJ56SYHS.js";import"./chunk-DW7GCGLI.js";import{a as _,b as T}from"./chunk-BI7C37SH.js";var A=(()=>{class t{estados=["Amazonas","Anzo\xE1tegui","Apure","Aragua","Barinas","Bol\xEDvar","Carabobo","Cojedes","Delta Amacuro","Distrito Capital","Falc\xF3n","Gu\xE1rico","Lara","M\xE9rida","Miranda","Monagas","Nueva Esparta","Portuguesa","Sucre","T\xE1chira","Trujillo","Vargas","Yaracuy","Zulia"];tarifarios=[{id:1,estado:"Miranda",tipoVehiculo:"estandar",costoPorKilometro:5.5,activo:!0,proveedorId:1},{id:2,estado:"Miranda",tipoVehiculo:"alta_gama",costoPorKilometro:8.75,activo:!0,proveedorId:2}];proveedores=[{id:1,nombre:"Transportes Express",activo:!0},{id:2,nombre:"Log\xEDstica R\xE1pida",activo:!0},{id:3,nombre:"Servicios de Transporte VIP",activo:!0},{id:4,nombre:"Transportes del Este",activo:!0}];getTarifarios(){return u(this.tarifarios.filter(e=>e.activo))}getEstados(){return this.estados}getTiposVehiculo(){return[{id:"estandar",nombre:"Est\xE1ndar"},{id:"alta_gama",nombre:"Alta Gama"}]}getTarifarioById(e){return u(this.tarifarios.find(i=>i.id===e))}getProveedores(){return u(this.proveedores.filter(e=>e.activo))}crearTarifario(e){let i=T(_({},e),{id:Math.max(...this.tarifarios.map(a=>a.id))+1,activo:!0});return this.tarifarios.push(i),u(i)}actualizarTarifario(e){let i=this.tarifarios.findIndex(a=>a.id===e.id);return i!==-1?(this.tarifarios[i]=_({},e),u(this.tarifarios[i])):u(e)}eliminarTarifario(e){let i=this.tarifarios.findIndex(a=>a.id===e);return i!==-1?(this.tarifarios[i].activo=!1,u(!0)):u(!1)}static \u0275fac=function(i){return new(i||t)};static \u0275prov=B({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function ve(t,m){if(t&1){let e=z();o(0,"tr")(1,"td"),n(2),r(),o(3,"td"),n(4),r(),o(5,"td")(6,"span",22),n(7),r()(),o(8,"td"),n(9),r(),o(10,"td",23),n(11),$(12,"currency"),r(),o(13,"td")(14,"button",24),p("click",function(){let a=w(e).$implicit,d=E();return D(d.editarTarifario(a.id))}),h(15,"i",25),n(16," Editar "),r(),o(17,"button",26),p("click",function(){let a=w(e).$implicit,d=E();return D(d.confirmarEliminacion(a.id))}),h(18,"i",27),n(19," Eliminar "),r()()()}if(t&2){let e=m.$implicit,i=E();l(2),y(e.estado),l(2),y(i.getTipoVehiculoNombre(e.tipoVehiculo)),l(2),s("ngClass",e.proveedorId?"bg-info":"bg-success"),l(),f(" ",e.proveedorId?"Espec\xEDfica":"General"," "),l(2),f(" ",e.proveedorNombre||"N/A"," "),l(2),y(L(12,6,e.costoPorKilometro,"USD","symbol","1.2-2"))}}function he(t,m){t&1&&(o(0,"tr")(1,"td",28),n(2,"No hay tarifarios registrados"),r()())}function be(t,m){t&1&&h(0,"div",29)}var ce=(()=>{class t{tarifariosService;router;tarifarios=[];mostrarConfirmacion=!1;tarifarioAEliminar=null;tiposVehiculo=[];proveedores=[];constructor(e,i){this.tarifariosService=e,this.router=i}ngOnInit(){this.cargarDatos(),this.tiposVehiculo=this.tarifariosService.getTiposVehiculo()}cargarDatos(){O({tarifarios:this.tarifariosService.getTarifarios(),proveedores:this.tarifariosService.getProveedores()}).subscribe(({tarifarios:e,proveedores:i})=>{this.proveedores=i,this.tarifarios=e.map(a=>T(_({},a),{proveedorNombre:a.proveedorId?i.find(d=>d.id===a.proveedorId)?.nombre:void 0}))})}getTipoVehiculoNombre(e){return this.tiposVehiculo.find(i=>i.id===e)?.nombre||e}crearNuevoTarifario(){this.router.navigate(["/apps/tarifarios/nuevo"])}editarTarifario(e){this.router.navigate(["/apps/tarifarios/editar",e])}confirmarEliminacion(e){this.tarifarioAEliminar=e,this.mostrarConfirmacion=!0}eliminarTarifario(){this.tarifarioAEliminar&&this.tarifariosService.eliminarTarifario(this.tarifarioAEliminar).subscribe(()=>{this.cargarDatos(),this.cerrarConfirmacion()})}cerrarConfirmacion(){this.mostrarConfirmacion=!1,this.tarifarioAEliminar=null}static \u0275fac=function(i){return new(i||t)(v(A),v(k))};static \u0275cmp=x({type:t,selectors:[["app-tarifarios"]],decls:43,vars:7,consts:[[1,"card"],[1,"card-header"],[1,"d-flex","justify-content-between","align-items-center"],[1,"card-title","mb-0"],[1,"btn","btn-primary",3,"click"],[1,"ti","ti-plus"],[1,"card-body"],[1,"table-responsive"],[1,"table","table-bordered"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"modal"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button",1,"btn-close",3,"click"],[1,"modal-body"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],["type","button",1,"btn","btn-danger",3,"click"],["class","modal-backdrop fade show",4,"ngIf"],[1,"badge",3,"ngClass"],[1,"text-end"],[1,"btn","btn-warning","btn-sm","me-2",3,"click"],[1,"ti","ti-edit"],[1,"btn","btn-danger","btn-sm",3,"click"],[1,"ti","ti-trash"],["colspan","6",1,"text-center"],[1,"modal-backdrop","fade","show"]],template:function(i,a){i&1&&(o(0,"div",0)(1,"div",1)(2,"div",2)(3,"h4",3),n(4,"Tarifas de Asistencia Vial"),r(),o(5,"button",4),p("click",function(){return a.crearNuevoTarifario()}),h(6,"i",5),n(7," Nuevo Tarifario "),r()()(),o(8,"div",6)(9,"div",7)(10,"table",8)(11,"thead")(12,"tr")(13,"th"),n(14,"Estado"),r(),o(15,"th"),n(16,"Tipo de Veh\xEDculo"),r(),o(17,"th"),n(18,"Tipo de Tarifa"),r(),o(19,"th"),n(20,"Proveedor"),r(),o(21,"th"),n(22,"Costo por Kil\xF3metro"),r(),o(23,"th"),n(24,"Acciones"),r()()(),o(25,"tbody"),c(26,ve,20,11,"tr",9)(27,he,3,0,"tr",10),r()()(),o(28,"div",11)(29,"div",12)(30,"div",13)(31,"div",14)(32,"h5",15),n(33,"Confirmar Eliminaci\xF3n"),r(),o(34,"button",16),p("click",function(){return a.cerrarConfirmacion()}),r()(),o(35,"div",17),n(36," \xBFEst\xE1 seguro que desea eliminar este tarifario? "),r(),o(37,"div",18)(38,"button",19),p("click",function(){return a.cerrarConfirmacion()}),n(39," Cancelar "),r(),o(40,"button",20),p("click",function(){return a.eliminarTarifario()}),n(41," Confirmar Eliminaci\xF3n "),r()()()()(),c(42,be,1,0,"div",21),r()()),i&2&&(l(26),s("ngForOf",a.tarifarios),l(),s("ngIf",a.tarifarios.length===0),l(),G("display",a.mostrarConfirmacion?"block":"none"),R("show",a.mostrarConfirmacion),l(14),s("ngIf",a.mostrarConfirmacion))},dependencies:[J,V,P,U],encapsulation:2})}return t})();function ge(t,m){if(t&1&&(o(0,"option",22),n(1),r()),t&2){let e=m.$implicit;s("value",e),l(),f(" ",e," ")}}function _e(t,m){t&1&&(o(0,"div",23),n(1," El estado es requerido "),r())}function Te(t,m){if(t&1&&(o(0,"option",22),n(1),r()),t&2){let e=m.$implicit;s("value",e.id),l(),f(" ",e.nombre," ")}}function Ee(t,m){t&1&&(o(0,"div",23),n(1," El tipo de veh\xEDculo es requerido "),r())}function Ce(t,m){if(t&1&&(o(0,"option",22),n(1),r()),t&2){let e=m.$implicit;s("value",e.id),l(),f(" ",e.nombre," ")}}function Se(t,m){t&1&&(o(0,"div",23),n(1," El proveedor es requerido "),r())}function Ie(t,m){if(t&1&&(o(0,"div",5)(1,"div",6)(2,"div",7)(3,"label",8),n(4,"Proveedor"),r(),o(5,"select",24)(6,"option",10),n(7,"Seleccione un proveedor"),r(),c(8,Ce,2,2,"option",11),r(),c(9,Se,2,0,"div",12),r()()()),t&2){let e,i=E();l(8),s("ngForOf",i.proveedores),l(),s("ngIf",((e=i.tarifarioForm.get("proveedorId"))==null||e.errors==null?null:e.errors.required)&&((e=i.tarifarioForm.get("proveedorId"))==null?null:e.touched))}}function xe(t,m){t&1&&(o(0,"div",23),n(1," El costo por kil\xF3metro es requerido "),r())}function Fe(t,m){t&1&&(o(0,"div",23),n(1," El costo debe ser mayor a 0 "),r())}var K=(()=>{class t{fb;tarifariosService;router;route;tarifarioForm;modoEdicion=!1;tarifarioId=null;estados=[];tiposVehiculo=[];proveedores=[];constructor(e,i,a,d){this.fb=e,this.tarifariosService=i,this.router=a,this.route=d,this.tarifarioForm=this.fb.group({estado:["",C.required],tipoVehiculo:["",C.required],costoPorKilometro:["",[C.required,C.min(.01)]],esParaProveedor:[!1],proveedorId:[null]}),this.tarifarioForm.get("esParaProveedor")?.valueChanges.subscribe(b=>{let g=this.tarifarioForm.get("proveedorId");b?g?.setValidators(C.required):(g?.clearValidators(),g?.setValue(null)),g?.updateValueAndValidity()})}ngOnInit(){this.estados=this.tarifariosService.getEstados(),this.tiposVehiculo=this.tarifariosService.getTiposVehiculo(),this.tarifariosService.getProveedores().subscribe(i=>{this.proveedores=i});let e=this.route.snapshot.params.id;e&&(this.modoEdicion=!0,this.tarifarioId=+e,this.cargarTarifario(this.tarifarioId))}cargarTarifario(e){this.tarifariosService.getTarifarioById(e).subscribe(i=>{i&&this.tarifarioForm.patchValue({estado:i.estado,tipoVehiculo:i.tipoVehiculo,costoPorKilometro:i.costoPorKilometro,esParaProveedor:!!i.proveedorId,proveedorId:i.proveedorId||null})})}guardar(){if(this.tarifarioForm.valid){let e=this.tarifarioForm.value,i={estado:e.estado,tipoVehiculo:e.tipoVehiculo,costoPorKilometro:e.costoPorKilometro,proveedorId:e.esParaProveedor?e.proveedorId:null};if(this.modoEdicion&&this.tarifarioId){let a=T(_({id:this.tarifarioId},i),{activo:!0});this.tarifariosService.actualizarTarifario(a).subscribe(()=>{this.router.navigate(["/apps/tarifarios"])})}else this.tarifariosService.crearTarifario(i).subscribe(()=>{this.router.navigate(["/apps/tarifarios"])})}}cancelar(){this.router.navigate(["/apps/tarifarios"])}static \u0275fac=function(i){return new(i||t)(v(se),v(A),v(k),v(Z))};static \u0275cmp=x({type:t,selectors:[["app-tarifario-form"]],decls:47,vars:12,consts:[[1,"card"],[1,"card-header"],[1,"card-title"],[1,"card-body"],[3,"ngSubmit","formGroup"],[1,"row"],[1,"col-md-4"],[1,"form-group","mb-3"],[1,"form-label"],["formControlName","estado",1,"form-select"],["value",""],[3,"value",4,"ngFor","ngForOf"],["class","invalid-feedback",4,"ngIf"],["formControlName","tipoVehiculo",1,"form-select"],[1,"form-check","form-switch"],["type","checkbox","formControlName","esParaProveedor","id","esParaProveedor",1,"form-check-input"],["for","esParaProveedor",1,"form-check-label"],["class","row",4,"ngIf"],["type","number","formControlName","costoPorKilometro","placeholder","0.00","step","0.01","min","0.01",1,"form-control"],[1,"mt-3"],["type","submit",1,"btn","btn-primary","me-2",3,"disabled"],["type","button",1,"btn","btn-secondary",3,"click"],[3,"value"],[1,"invalid-feedback"],["formControlName","proveedorId",1,"form-select"]],template:function(i,a){if(i&1&&(o(0,"div",0)(1,"div",1)(2,"h4",2),n(3),r()(),o(4,"div",3)(5,"form",4),p("ngSubmit",function(){return a.guardar()}),o(6,"div",5)(7,"div",6)(8,"div",7)(9,"label",8),n(10,"Estado"),r(),o(11,"select",9)(12,"option",10),n(13,"Seleccione un estado"),r(),c(14,ge,2,2,"option",11),r(),c(15,_e,2,0,"div",12),r()(),o(16,"div",6)(17,"div",7)(18,"label",8),n(19,"Tipo de Veh\xEDculo"),r(),o(20,"select",13)(21,"option",10),n(22,"Seleccione un tipo"),r(),c(23,Te,2,2,"option",11),r(),c(24,Ee,2,0,"div",12),r()(),o(25,"div",6)(26,"div",7)(27,"label",8),n(28,"\xBFTarifa espec\xEDfica para proveedor?"),r(),o(29,"div",14),h(30,"input",15),o(31,"label",16),n(32),r()()()()(),c(33,Ie,10,2,"div",17),o(34,"div",5)(35,"div",6)(36,"div",7)(37,"label",8),n(38,"Costo por Kil\xF3metro"),r(),h(39,"input",18),c(40,xe,2,0,"div",12)(41,Fe,2,0,"div",12),r()()(),o(42,"div",19)(43,"button",20),n(44),r(),o(45,"button",21),p("click",function(){return a.cancelar()}),n(46," Cancelar "),r()()()()()),i&2){let d,b,g,q,S,M;l(3),f("",a.modoEdicion?"Editar":"Nuevo"," Tarifario"),l(2),s("formGroup",a.tarifarioForm),l(9),s("ngForOf",a.estados),l(),s("ngIf",((d=a.tarifarioForm.get("estado"))==null||d.errors==null?null:d.errors.required)&&((d=a.tarifarioForm.get("estado"))==null?null:d.touched)),l(8),s("ngForOf",a.tiposVehiculo),l(),s("ngIf",((b=a.tarifarioForm.get("tipoVehiculo"))==null||b.errors==null?null:b.errors.required)&&((b=a.tarifarioForm.get("tipoVehiculo"))==null?null:b.touched)),l(8),f(" ",(g=a.tarifarioForm.get("esParaProveedor"))!=null&&g.value?"S\xED":"No"," "),l(),s("ngIf",(q=a.tarifarioForm.get("esParaProveedor"))==null?null:q.value),l(7),s("ngIf",((S=a.tarifarioForm.get("costoPorKilometro"))==null||S.errors==null?null:S.errors.required)&&((S=a.tarifarioForm.get("costoPorKilometro"))==null?null:S.touched)),l(),s("ngIf",(M=a.tarifarioForm.get("costoPorKilometro"))==null||M.errors==null?null:M.errors.min),l(2),s("disabled",!a.tarifarioForm.valid),l(),f(" ",a.modoEdicion?"Actualizar":"Crear"," Tarifario ")}},dependencies:[V,P,ee,ae,ne,Q,ie,H,oe,W,X,le,te,re],encapsulation:2})}return t})();var pe=(()=>{class t{static \u0275fac=function(i){return new(i||t)};static \u0275mod=F({type:t});static \u0275inj=I({imports:[Y,de]})}return t})();var ye=[{path:"apps/tarifarios",children:[{path:"",component:ce},{path:"nuevo",component:K},{path:"editar/:id",component:K}]}],Ye=(()=>{class t{static \u0275fac=function(i){return new(i||t)};static \u0275mod=F({type:t});static \u0275inj=I({imports:[j.forChild(ye),pe,j]})}return t})();export{Ye as TarifariosRoutingModule};
